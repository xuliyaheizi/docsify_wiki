# 22年6月24日小记

## 项目技术点说明

<img src="https://knowledgeimagebed.oss-cn-hangzhou.aliyuncs.com/img/image-20220624115059752.png" alt="image-20220624115059752" width="67%;" />





1. sink组: 负载均衡

2. 多source汇总. 

Ganglia: 任务执行情况监控   -> JVM

3. 自定义 Source  
     自定义 Sink. 

4. 过滤器  -> 扩展. 

## 云盘项目扩展

1. node1:请安装 mysql, ngix, tomcat

2. 请配置 flume 采集 nginx, tomcat运行日志，入库到 hdfs中. 

3. 请配置好云盘项目的 日志, 发布你云盘项目,打成 jar包，运行起来, 
     用flume采集此项目的日志。 

4. 请将云盘项目动静分离. 静态资源 html, css, js放到 nginx中， 后台部分打成jar独立运行，生成日志，
   由flume采集日志发到 hdfs 保存. 

### hadoop上安装nginx

安装相关依赖包

```shell
sudo yum -y install openssl openssl-devel pcre pcre-devel zlib zlib-devel gcc gcc-c++
```

将nginx文件上传到 /tmp/nginx

```
Ngnix下载地址：http://nginx.org/en/download.html
```

进入nginx目录下，执行以下命令

```shell
./configure   --prefix=/usr/local/nginx

make && make install
```

启动nginx

```shell
在/opt/module/nginx/sbin目录下执行  ./nginx

#查看启动情况
ps -ef |grep nginx
```

### hadoop安装mysql

下载安装包，将压缩包上传至 /opt/mysql，并解压

```
https://dev.mysql.com/downloads/file/?id=511379

tar -xf mysql-8.0.29-1.el7.x86_64.rpm-bundle.tar
```

添加用户组

```
 groupadd mysql
 添加用户组
 
 useradd -g mysql mysql
 添加用户
 
 id mysql
 查看用户信息。
```

卸载MariaDB

```
rpm -qa | grep mariadb查询是否有该软件
如果有，就卸载：rpm -e mariadb-libs-这里是你的版本，如果不能卸载（或报错）则采用强制卸载：rpm -e --nodeps mariadb-libs-这里是你的版本
```

安装Mysql

```
rpm -ivh *.rpm
安装过程要按照如下顺序（必须）进行：

	 mysql-community-common-5.7.9-1.el7.x86_64.rpm
	 mysql-community-libs-5.7.9-1.el7.x86_64.rpm             --（依赖于common）
	 mysql-community-client-5.7.9-1.el7.x86_64.rpm          --（依赖于libs）
	 mysql-community-server-5.7.9-1.el7.x86_64.rpm         --（依赖于client、common）
	按照以上顺序进行一个个的安装，脚本如下：
	
	rpm -ivh mysql-community-server-5.7.16-1.el7.x86_64.rpm
	
期间缺少啥组件，安装啥
libaio.so.1()(64bit) is needed by mysql-community-embedded-compat-8.0.29-1.el7.x86_64

yum -y install libaio
```

```
mysql安装软件在/usr/share/mysql目录下

Mysql数据库创建在/var/lib/mysql目录下
```

我们进入到mysql这个目录中，更改一下权限：

```
cd /usr/share/mysql/
chown -R mysql:mysql .
```
